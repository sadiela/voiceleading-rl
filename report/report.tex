\documentclass[12pt, letterpaper]{article}
\usepackage[english]{babel}
\usepackage{parskip}
\usepackage{amsmath}
\usepackage{amsfonts}

\title{
    EC700 Project Report \\
    Reinforcement Learning on Harmonic Progression
}
\author{Sadie Allen, Chonghua Xue, Liam Ramsay}
\date{May 1st, 2023}

\begin{document}
\maketitle
\newpage

\section{Introduction}

The intersection of music theory and artificial intelligence has long been a fascinating area of study, with researchers consistently uncovering novel ways to analyze, compose, and understand music. In this report, we explore a unique approach to this interdisciplinary challenge, focusing on the application of reinforcement learning to harmonic progression in music theory. By examining the complex relationships between chords and progressions, we aim to create a computational model that can learn, predict, and generate harmonic sequences using the principles of reinforcement learning.

Harmonic progression lies at the heart of Western music, providing the foundation for the listener's sense of tension and resolution, as well as contributing to the overall emotional impact of a piece. Traditionally, music theorists have devised rules and guidelines for creating harmonically pleasing progressions, which are based on centuries of musical practice and observation. However, these rules are often complex and difficult for both humans and machines to navigate. In this project, we seek to teach an artificial intelligence agent the principles of harmonic progression through the use of reinforcement learning, allowing it to autonomously learn and adapt its knowledge of these rules as it interacts with its environment.

By leveraging reinforcement learning, our project aims to develop a model that can intelligently navigate the intricate world of harmonic progressions, learning from experience and refining its understanding of music theory over time.

This report will detail the methodology, implementation, and results of our reinforcement learning approach to harmonic progression, as well as discuss the broader implications of our findings for the future of music composition and analysis. We will begin by providing an overview of the relevant background in music theory and reinforcement learning, followed by an in-depth explanation of our proposed model and its implementation. Finally, we will present the results of our experiments and discuss their implications for the field of music theory and artificial intelligence.

\section{Problem Formulation}

Given a sequence of chords (e.g., I, vi, IV, ii), the objective is to generate 4-part voicings for each chord in the sequence. This problem can be viewed from two distinct perspectives: as a sequence of chords and as four separate musical lines, each representing one of the four voice parts (soprano, alto, tenor, and bass). While harmonic progression provides us with the notes that must be present in each chord, it does not dictate which voice part should play which note. This absence of specific guidance leads to numerous possible voicing combinations, making the problem inherently complex.

\subsection{General Challenges}

There are a couple of challenges involved. For example, generating 4-part voicings requires adherence to the principles of \textbf{voice leading}, which aim to create smooth and coherent transitions between successive chords. Voice leading ensures that each individual voice part maintains its independence while also contributing to the overall harmony. Complying with these principles often involves minimizing leaps, avoiding parallel fifths and octaves, and preserving common tones between chords whenever possible.

In addition, different \textbf{inversions} of a chord can significantly alter the overall sound and harmonic function. For instance, a first inversion chord will have a distinct sonic character compared to its root position counterpart. The model must be capable of intelligently determining which inversion is the most appropriate for a given context, taking into consideration the surrounding chords and overall harmonic progression.

Musical context is another real challenge for musicians to addreass, as the optimal 4-part voicing for a specific chord may vary depending on its context within a piece. Factors such as melody, rhythm, and texture can all influence the ideal voicing choice. However, to simplify our problem, this issue will not be tackles at the current stage. We assume that each short sequence of chords are indepent and is considered good as long as it's consistent within its own scope.

\subsection{Constraints \& Simplifications}

In order to make the problem of generating 4-part voicings more manageable and computationally tractable, we introduce certain constraints and simplifications to our study. These assumptions allow us to focus on the essential aspects of the problem, while reducing the complexity of the learning task for our reinforcement learning model.

\begin{enumerate}
    \item \textbf{Fixed Harmonic Progression} - For the purpose of this study, we assume that the harmonic progression is already given and our primary objective is to provide the appropriate voicings for each chord in the sequence. This allows us to concentrate on the intricacies of voicing generation and voice leading, without the additional challenge of predicting or generating chord progressions.
    \item \textbf{C Major Only} - To further simplify the problem, we restrict our study to the key of C major. This constraint allows us to avoid complications that arise from key changes and to focus on the fundamental principles of harmony and voice leading. Although this limitation reduces the scope of the study, the insights gained can still be applied to other keys with appropriate transposition.
    \item \textbf{Root Position Chords} - We consider only chords in root position, meaning that the bass note of each chord is the lowest note of the chord. By excluding chord inversions, we reduce the number of possible voicings and streamline the learning process for our model. This simplification, however, comes at the cost of limiting the harmonic variety and richness that inversions can provide.
    \item \textbf{Voice Part Range Restrictions} - In order to maintain the realism and practicality of our generated voicings, we restrict the range of each voice part as follows:
    \begin{itemize}
        \item Bass: E2 (MIDI note 40) to C4 (MIDI note 60)
        \item Tenor: C3 (MIDI note 48) to G4 (MIDI note 67)
        \item Alto: G3 (MIDI note 55) to D5 (MIDI note 74)
        \item Soprano: C4 (MIDI note 60) to G5 (MIDI note 79)
    \end{itemize}
\end{enumerate}

While these assumptions do limit the overall complexity and scope of the study, they allow us to focus on the core aspects of harmony and voice leading, providing valuable insights that can be further extended to more complex scenarios in future research.

\subsection{Voice Leading Rules}

In this section, we detail several important voice leading rules that our reinforcement learning model should adhere to when generating voicings for the given harmonic progression. By following these guidelines, our model can create smooth transitions between chords and ensure that each voice part maintains its independence while contributing to the overall harmony.

\begin{enumerate}
    \item \textbf{Spacing} - Keep the upper three parts (soprano, alto, and tenor) within an octave of each other. This close spacing helps maintain a sense of cohesion among the upper voices. Allow more than an octave between the tenor and bass parts, as this wider spacing can provide a stronger foundation for the harmony.
    \item \textbf{Leaps} - Avoid leaps of 7ths and intervals larger than an octave, especially in the soprano line. Large leaps can create a disjointed melodic line and disrupt the overall sense of musical continuity.
    \item \textbf{Voice Crossing} - Do not allow any part to cross above the soprano or below the bass. Maintaining the proper order of the voice parts is essential for preserving their independence and preventing confusion. Brief crossing of alto and tenor lines is acceptable, but it is generally better to avoid such instances to maintain the distinct identity of each part.
    \item \textbf{Parallel 5ths and Octaves} - Parallel 5ths and octaves between the same set of voices are considered unacceptable, as they weaken the independence of the individual voice parts. However, parallel 3rds are acceptable and can contribute to a harmonically rich texture.
    \item \textbf{Direct 5ths and Octaves} - Direct 5ths and octaves occur when the outer parts (soprano and bass) or two adjacent parts move in the same direction into a perfect fifth (P5) or perfect octave (P8) with a leap in the upper part. These instances should be avoided, as they can create a sense of harmonic blandness or weaken the independence of the voice parts.
\end{enumerate}

\section{Methods}

\section{Results}

\section{Discussions}

Our current study offers valuable insights into the application of reinforcement learning for generating 4-part voicings in harmonic progressions. However, there are several opportunities for future work and extensions that can broaden the scope and applicability of our findings.

One avenue for future work is to generalize the model by removing the constraints of the study. This would involve expanding the model's capabilities to handle different keys, chord types, and harmonic progressions beyond the limitations imposed in the current study. Building on this idea, we could also train the reinforcement learning model to autonomously generate harmonic progressions instead of providing them as input. This extension would enable the creation of complete compositions, encompassing both harmonic progression generation and voicing assignment.

To further enhance the harmonic variety and richness of the generated music, the model could be extended to include 7th chords and chord inversions. This would allow for more complex and sophisticated harmonic progressions, improving the musical quality of the generated output. In addition, while our current study focuses on the key of C major, future work could extend the model to handle minor keys, broadening its applicability and providing a more comprehensive understanding of harmony in Western music.

Another interesting extension is to train the model to generate harmonizations for a given melody. In this scenario, the model would be tasked with creating a suitable harmonic progression and voicing assignment that complements the provided melodic line. This presents an additional layer of complexity and offers an opportunity for more creative exploration in reinforcement learning applications.

These suggested future directions offer exciting possibilities for advancing our understanding of the interplay between reinforcement learning, harmonic progression, and voice leading. By pursuing these extensions, researchers can continue to push the boundaries of artificial intelligence in the realm of music composition and analysis, contributing to the ongoing development of innovative tools and techniques in the field.

\end{document}